---
# Default variables for high-availability role

# HA Configuration
ha_enabled: true
jenkins_ha_enabled: true
jenkins_ha_mode: "active-passive"  # active-passive or active-active
jenkins_master_count: 2

# Multi-Team Configuration
jenkins_domain: "devops.example.com"
jenkins_wildcard_domain: "*.devops.example.com"
jenkins_default_subdomain: "jenkins"
team_routing_enabled: true

# Load Balancer Configuration (HAProxy)
haproxy_enabled: true
haproxy_stats_enabled: true
haproxy_stats_port: 8404
haproxy_stats_uri: "/stats"
haproxy_stats_user: "admin"
haproxy_stats_password: "{{ vault_haproxy_stats_password | default('changeme') }}"
haproxy_check_interval: "5s"
haproxy_check_fall: 3
haproxy_check_rise: 2
haproxy_timeout_connect: "5s"
haproxy_timeout_client: "300s"
haproxy_timeout_server: "300s"
haproxy_maxconn: 8192

# Virtual IP Configuration (keepalived)
keepalived_enabled: false
jenkins_vip: ""  # Set this to enable VIP
keepalived_interface: "{{ ansible_default_ipv4.interface }}"
keepalived_priority: 100  # Higher number = higher priority
keepalived_vrid: 51
keepalived_advert_int: 1
keepalived_auth_pass: "changeme"

# Health Check Configuration
health_check_enabled: true
health_check_interval: 30
health_check_timeout: 10
health_check_retries: 3
health_check_path: "/login"

# Failover Configuration
failover_enabled: true
failover_timeout: 60
failover_max_attempts: 3
failover_notification_enabled: false

# SSL Configuration for Wildcard Domain
ssl_enabled: true
ssl_cert_path: "/etc/ssl/certs/wildcard.devops.example.com.pem"
ssl_key_path: "/etc/ssl/private/wildcard.devops.example.com.key"
ssl_ca_cert_path: "/etc/ssl/certs/ca-chain.pem"
ssl_redirect_http: true
ssl_protocols: "TLSv1.2 TLSv1.3"
ssl_ciphers: "ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:RSA+AESGCM:RSA+AES:!aNULL:!MD5:!DSS"

# Backend Server Configuration
backend_check_enabled: true
backend_check_interval: "5s"
backend_check_timeout: "10s"
backend_max_connections: 100
backend_balance_method: "roundrobin"  # roundrobin, leastconn, source

# Monitoring Configuration
monitoring_enabled: true
monitoring_interval: 120  # seconds
monitoring_log_file: "/var/log/jenkins-ha-monitor.log"
monitoring_alert_enabled: false
