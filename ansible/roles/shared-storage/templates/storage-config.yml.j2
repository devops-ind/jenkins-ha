# Shared Storage Configuration
# Generated by Ansible - Do not modify manually

storage:
  type: "{{ shared_storage_type }}"
  path: "{{ shared_storage_path }}"
  owner: "{{ shared_storage_owner }}"
  group: "{{ shared_storage_group }}"
  
directories:
  home: "{{ shared_storage_path }}/home"
  workspace: "{{ shared_storage_path }}/workspace"
  builds: "{{ shared_storage_path }}/builds"
  jobs: "{{ shared_storage_path }}/jobs"
  plugins: "{{ shared_storage_path }}/plugins"
  logs: "{{ shared_storage_path }}/logs"
  backup: "{{ shared_storage_path }}/backup"
  secrets: "{{ shared_storage_path }}/secrets"
  casc_configs: "{{ shared_storage_path }}/casc_configs"

{% if shared_storage_type == "nfs" %}
nfs:
  server: "{{ nfs_server | default('localhost') }}"
  export_path: "{{ nfs_export_path | default('/opt/jenkins-shared') }}"
  mount_options: "{{ nfs_mount_options | default('defaults,noatime,nodiratime,intr,_netdev') }}"
{% endif %}

{% if shared_storage_type == "glusterfs" %}
glusterfs:
  volume: "{{ glusterfs_volume | default('jenkins-volume') }}"
  servers: {{ glusterfs_servers | default(['localhost']) | to_yaml }}
  mount_options: "{{ glusterfs_mount_options | default('defaults,_netdev') }}"
{% endif %}

permissions:
  mode: "0755"
  recursive: true

# Backup configuration
backup:
  enabled: {{ backup_enabled | default(true) | lower }}
  retention_days: {{ backup_retention_days | default(30) }}
  schedule: "{{ backup_schedule_hour | default(2) }} {{ backup_schedule_minute | default(0) }} * * *"

# Monitoring
monitoring:
  disk_usage_threshold: 85
  free_space_alert_gb: 10