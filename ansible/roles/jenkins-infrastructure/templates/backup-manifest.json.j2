{
  "backup_info": {
    "backup_id": "{{ backup_date }}",
    "timestamp": "{{ ansible_date_time.iso8601 }}",
    "reason": "{{ backup_reason }}",
    "environment": "{{ backup_env }}",
    "created_by": "ansible-blue-green-deployment"
  },
  
  "system_info": {
    "hostname": "{{ ansible_hostname }}",
    "ansible_user": "{{ ansible_user_id }}",
    "container_runtime": "{{ jenkins_container_runtime }}",
    "deployment_mode": "blue-green"
  },
  
  "backup_components": {
    "jenkins_home": {
      "source": "{{ shared_storage_path | default('/shared/jenkins') }}/shared-home/",
      "destination": "{{ shared_storage_path | default('/shared/jenkins') }}/backups/{{ backup_date }}/jenkins-home/",
      "type": "directory_sync",
      "command": "{{ backup_files.jenkins_home }}",
      "status": "{{ 'completed' if jenkins_home_backup is succeeded else 'failed' }}"
    },
    "plugins": {
      "source": "{{ shared_storage_path | default('/shared/jenkins') }}/shared-plugins/",
      "destination": "{{ shared_storage_path | default('/shared/jenkins') }}/backups/{{ backup_date }}/plugins/",
      "type": "directory_sync",
      "command": "{{ backup_files.plugins }}",
      "status": "{{ 'completed' if plugins_backup is succeeded else 'skipped' if plugins_backup is undefined else 'failed' }}"
    },
    "configuration": {
      "source": "{{ jenkins_home_dir }}/casc/",
      "destination": "{{ shared_storage_path | default('/shared/jenkins') }}/backups/{{ backup_date }}/config/",
      "type": "directory_copy",
      "status": "{{ 'completed' if config_backup is succeeded else 'failed' }}"
    },
    "blue_green_state": {
      "source": "{{ jenkins_home_dir }}/blue-green/state.json",
      "destination": "{{ backup_files.state }}",
      "type": "file_copy",
      "status": "{{ 'completed' if (jenkins_home_dir + '/blue-green/state.json') is file else 'skipped' }}"
    },
    "container_information": {
      "destination": "{{ backup_files.container_info }}",
      "type": "runtime_info",
      "containers": ["{{ jenkins_blue_container_name }}", "{{ jenkins_green_container_name }}"],
      "status": "{{ 'completed' if container_info is succeeded else 'failed' }}"
    }
  },
  
  "backup_metadata": {
    "backup_path": "{{ shared_storage_path | default('/shared/jenkins') }}/backups/{{ backup_date }}",
    "backup_size": "{{ backup_size.stdout.split('\t')[0] if backup_size is succeeded else 'calculating...' }}",
    "retention_days": {{ jenkins_backup_retention_days | default(30) }},
    "compression": "enabled",
    "verification_required": true
  },
  
  "restoration_info": {
    "restore_command": "ansible-playbook -i inventory restore-blue-green-backup.yml -e backup_id={{ backup_date }}",
    "restore_notes": [
      "Stop both blue and green containers before restoration",
      "Ensure shared storage is mounted correctly",
      "Verify container runtime compatibility",
      "Update blue-green state after restoration",
      "Restart containers in correct order",
      "Verify load balancer configuration"
    ]
  },
  
  "verification": {
    "checksum_files": [
      "jenkins-home/config.xml",
      "jenkins-home/jenkins.model.JenkinsLocationConfiguration.xml",
      "config/jenkins.yaml",
      "blue-green-state.json"
    ],
    "required_directories": [
      "jenkins-home",
      "plugins",
      "config"
    ],
    "verification_timestamp": null,
    "verification_status": "pending"
  }
}