---
# Jenkins Network Configuration
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

network:
  name: {{ jenkins_network_name }}
  driver: {{ jenkins_network_driver }}
  subnet: {{ jenkins_network_subnet }}
  gateway: {{ jenkins_network_gateway }}
  container_runtime: {{ jenkins_container_runtime }}

ports:
  jenkins_http: {{ jenkins_port }}
  jenkins_agent: {{ jenkins_agent_port }}
  
firewall:
  enabled: true
  allowed_ports:
    - "{{ jenkins_port }}/tcp"
    - "{{ jenkins_agent_port }}/tcp"

services:
  masters:
{% for i in range(1, jenkins_master_count + 1) %}
    - name: jenkins-master-{{ i }}
      port: {{ jenkins_port + i - 1 }}
      agent_port: {{ jenkins_agent_port + i - 1 }}
{% endfor %}

  agents:
    - name: dind-agent
      type: docker-in-docker
    - name: maven-agent
      type: java-maven
    - name: python-agent
      type: python
    - name: nodejs-agent
      type: nodejs