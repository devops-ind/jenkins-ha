---
# Local DevContainer Inventory for Jenkins HA Development
# This inventory runs all services on localhost within devcontainers

all:
  vars:
    ansible_connection: local
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    ansible_user: vscode
    environment: local
    deployment_mode: devcontainer
    become: true
    
    # Local development settings
    jenkins_domain: localhost
    harbor_domain: localhost
    monitoring_domain: localhost
    
    # Container networking for local development
    jenkins_network_name: "jenkins-dev-net"
    jenkins_network_subnet: "172.25.0.0/16"
    monitoring_network_name: "monitoring-dev-net" 
    monitoring_network_subnet: "172.26.0.0/16"

# Single localhost target for all services in devcontainer
localhost:
  hosts:
    localhost:
      ansible_connection: local
      ansible_python_interpreter: "{{ ansible_playbook_python }}"

# Jenkins Masters - all running on localhost with different ports
jenkins_masters:
  hosts:
    jenkins-master-local:
      ansible_connection: local
      ansible_host: localhost
      jenkins_master_port: 8080
      jenkins_container_name: jenkins-master-dev
      jenkins_volume_name: jenkins_data_dev
      jenkins_master_memory: "2g"
      jenkins_master_cpu_limit: "1"

# Optional second master for HA testing
jenkins_masters_ha:
  hosts:
    jenkins-master-local-ha:
      ansible_connection: local
      ansible_host: localhost
      jenkins_master_port: 8081
      jenkins_container_name: jenkins-master-ha-dev
      jenkins_volume_name: jenkins_data_ha_dev
      jenkins_master_memory: "2g"
      jenkins_master_cpu_limit: "1"

# Dynamic Jenkins Agents - Provisioned via Docker Cloud Plugin
# No static agent hosts needed - all agents are spawned dynamically
# Dynamic agents will be configured via JCasC for local development

# Monitoring stack - running on localhost with different ports
monitoring:
  hosts:
    monitoring-local:
      ansible_connection: local
      ansible_host: localhost
      prometheus_port: 9090
      prometheus_container_name: prometheus-dev
      grafana_port: 3000
      grafana_container_name: grafana-dev
      alertmanager_port: 9093
      alertmanager_container_name: alertmanager-dev
      node_exporter_port: 9100
      node_exporter_container_name: node-exporter-dev

# Harbor registry - running locally for development
harbor:
  hosts:
    harbor-local:
      ansible_connection: local
      ansible_host: localhost
      harbor_port: 8082
      harbor_container_name: harbor-dev
      harbor_admin_password: "{{ vault_harbor_admin_password | default('Harbor12345') }}"
      harbor_db_password: "{{ vault_harbor_db_password | default('root123') }}"

# Backup service - local development backup
backup:
  hosts:
    backup-local:
      ansible_connection: local
      ansible_host: localhost
      backup_container_name: backup-dev
      backup_mount_point: "/tmp/jenkins-backup"
      backup_local_dir: "/tmp/jenkins-backup-staging"

# Group assignments for easier management
jenkins_infrastructure:
  children:
    jenkins_masters:

monitoring_stack:
  children:
    monitoring:

registry_services:
  children:
    harbor:

development_services:
  children:
    jenkins_infrastructure:
    monitoring_stack:
    registry_services:
    backup: