---
# Production CentOS 9 VM Configuration
# Real production settings for Jenkins HA on CentOS 9

# Environment identification
deployment_environment: "production"
environment_tier: "prod"
deployment_mode: "production"

# CentOS 9 specific configurations
os_family: "RedHat"
package_manager: "dnf"
firewall_service: "firewalld"

# Jenkins configuration for production
jenkins_admin_user: "admin"
jenkins_admin_password: "{{ vault_jenkins_admin_password | default('admin123') }}"
jenkins_version: "lts"

# HAProxy configuration for production VM
haproxy_image_registry: "docker.io"
haproxy_image_name: "haproxy"
haproxy_image_tag: "2.8"  # Use stable Debian-based image
haproxy_stats_user: "admin"
haproxy_stats_password: "{{ vault_haproxy_stats_password | default('admin123') }}"

# Monitoring configuration
monitoring_enabled: true
prometheus_retention: "15d"  # Production retention
grafana_admin_user: "admin"
grafana_admin_password: "{{ vault_grafana_admin_password | default('admin123') }}"

# Backup configuration
backup_enabled: true
backup_retention_days: 30
backup_schedule_hour: 2
backup_schedule_minute: 0

# Docker configuration for CentOS 9
docker_edition: "ce"
docker_enable_audit: true  # Production security
docker_daemon_config:
  log-driver: "json-file"
  log-opts:
    max-size: "10m"
    max-file: "3"
  storage-driver: "overlay2"
  exec-opts:
    - "native.cgroupdriver=systemd"

# Security settings for production
security_hardening_enabled: true
selinux_enabled: true
selinux_policy: "targeted"
selinux_mode: "enforcing"

# Resource limits for production VM
jenkins_master_memory_limit: "2g"
jenkins_master_cpu_limit: "1.5"
haproxy_memory_limit: "512M"
haproxy_cpu_limit: "0.5"

# Network settings
jenkins_network_name: "jenkins-network"
monitoring_network_name: "monitoring-net"

# Shared storage settings
shared_storage_enabled: true
shared_storage_type: "local"
shared_storage_path: "/opt/jenkins-shared"
shared_storage_owner: "jenkins"
shared_storage_group: "jenkins"

# Production-specific user/group mappings to avoid conflicts
jenkins_uid: 1001
jenkins_gid: 1001
monitoring_uid: 1005
monitoring_gid: 1005
haproxy_uid: 1004

# HAProxy should bind to port 8090 (HTTP), avoiding privileged port 80 in host networking
jenkins_port: 8090
haproxy_gid: 1004

# Timezone
common_timezone: "UTC"

# Performance tuning for production
vm_swappiness: 10
vm_max_map_count: 262144

# Firewall ports to open
firewall_allowed_ports:
  - "8080/tcp"  # DevOps Jenkins
  - "8081/tcp"  # Developer Jenkins  
  - "8090/tcp"  # HAProxy HTTP
  - "443/tcp"   # HAProxy HTTPS (future)
  - "8404/tcp"  # HAProxy Stats
  - "9090/tcp"  # Prometheus
  - "9100/tcp"  # Node Exporter
  - "9200/tcp"  # cAdvisor
  - "9300/tcp"  # Grafana (changed from 3000)
  - "22/tcp"    # SSH